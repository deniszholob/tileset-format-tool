<!doctype html>
<html lang="en">
  <head>
    <!-- Meta Data -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Denis Zholob" />
    <meta name="keywords" content="Denis, Zholob" />
    <meta name="title" content="Tileset Format Tool" />
    <meta
      name="description"
      content="Tile set tool to convert wetween different tile set formats, and modify borders."
    />

    <!-- Google / Search Engine Tags -->
    <meta itemprop="name" content="Tileset Format Tool" />
    <meta
      itemprop="description"
      content="Tile set tool to convert wetween different tile set formats, and modify borders."
    />
    <meta itemprop="image" content="assets/icons/splash.png" />

    <!-- Facebook Meta Tags -->
    <meta property="og:url" content="https://github.com/deniszholob/tileset-format-tool" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Tileset Format Tool" />
    <meta
      property="og:description"
      content="Tile set tool to convert wetween different tile set formats, and modify borders."
    />
    <meta property="og:image" content="assets/icons/splash.png" />
    <meta property="og:author" content="Denis Zholob" />

    <!-- Twitter Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Tileset Format Tool" />
    <meta
      name="twitter:description"
      content="Tile set tool to convert wetween different tile set formats, and modify borders."
    />
    <meta name="twitter:image" content="assets/icons/splash.png" />
    <meta name="twitter:site" content="@deniszholob" />
    <meta name="twitter:creator" content="@deniszholob" />

    <!-- Title/Icon -->
    <title>Tileset Format Tool</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png" />
    <link rel="apple-touch-startup-image" href="assets/icons/splash.jpg" />
    <link rel="mask-icon" href="safari-pinned-tab.svg" color="#ffffff" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <!-- <base href="/" /> -->

    <!-- PWA -->
    <link rel="manifest" href="manifest.webmanifest" />
    <meta name="theme-color" content="#ffffff" />

    <!-- Meta Tags Generated via http://heymeta.com -->
    <!-- Icons generated with https://realfavicongenerator.net/ -->

    <!-- Prefetch/Preconnect -->
    <!-- <link rel="dns-prefetch" href="https://fonts.googleapis.com"> -->
    <!-- <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="anonymous"> -->
    <!-- <link rel="dns-prefetch" href="https://fonts.gstatic.com/s/"> -->
    <!-- <link rel="preconnect" href="https://fonts.gstatic.com/s/" crossorigin="anonymous"> -->
    <link rel="dns-prefetch" href="https://use.fontawesome.com" />
    <link rel="preconnect" href="https://use.fontawesome.com" crossorigin="anonymous" />

    <!-- Bootstrap -->
    <!-- <link rel="stylesheet" href="//stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
      crossorigin="anonymous"> -->

    <!-- Fonts -->
    <!-- https://fonts.google.com/specimen/VT323?preview.text=0123456789&query=VT323+ -->
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet" />
    <script
      defer
      src="https://use.fontawesome.com/releases/v6.4.0/js/all.js"
      integrity="sha384-Y7LSKwoY+C2iyfu/oupNnkGEN3EgA6skmJeVg5AyQk7ttcjX0XsLREmmuJW/SdbU"
      crossorigin="anonymous"
    ></script>

    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-28080172-12"></script>
    <script async="">
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "UA-28080172-12");
    </script>

    <!-- Stylesheets -->
    <link rel="stylesheet" href="./styles/styles.css" />
  </head>

  <body class="min-w-screen flex h-svh min-h-screen flex-col justify-center" onload="onLoad()">
    <!-- Without this image doesn't load programmatically for some reason -->
    <img id="bitMask32" src="assets/bit-mask-tiles-bw_32.png" class="hidden" />
    <img id="bitMask64" src="assets/bit-mask-tiles-bw_64.png" class="hidden" />

    <div class="m-auto h-full w-full p-4" style="max-width: 1920px">
      <section id="header" class="m-0 flex flex-col gap-2 rounded-btn bg-neutral p-4">
        <div class="flex flex-row flex-wrap items-center justify-center gap-4">
          <div class="flex flex-row items-center gap-4">
            <h1 class="text-3xl">Tile Set Tool</h1>
            <a
              href="https://gamedev.stackexchange.com/questions/148460/combinations-for-tiling-two-textures-together/148464#148464"
              target="_blank"
              rel="noopener noreferrer"
              class="link link-info tooltip tooltip-right"
              data-tip="Tile Sets Overview"
            >
              <i class="fa-solid fa-circle-info fa-lg"></i>
            </a>
          </div>

          <div id="navLinks" class="flex flex-1 flex-row flex-wrap justify-center gap-10">
            <!-- Inject templateNavItem instances here -->
          </div>
          <template id="templateNavItem">
            <a id="templateNavLink_idx_" href="./page.html" class="link link-secondary text-xl">
              PageTitle
            </a>
          </template>

          <div class="flex flex-none flex-row items-center gap-4">
            <a
              class="link link-primary tooltip tooltip-left"
              data-tip="Discord Chat"
              href="https://discord.gg/PkyzXzz"
            >
              <i class="fa-brands fa-discord fa-xl"></i>
            </a>

            <a
              class="link link-primary tooltip tooltip-left"
              data-tip="Github Source Code"
              href="https://github.com/deniszholob/tileset-format-tool"
            >
              <i class="fa-brands fa-github fa-xl"></i>
            </a>

            <div class="flex flex-col text-center text-sm">
              <span>Updated</span>
              <span id="updateDate"></span>
            </div>

            <!-- TODO: Enable theme switch -->
            <label class="swap swap-rotate">
              <input type="checkbox" class="theme-controller" value="dark" disabled />
              <i class="fa-solid fa-sun fa-lg swap-on text-amber-500"></i>
              <i class="fa-solid fa-moon fa-lg swap-off text-purple-500"></i>
            </label>
          </div>
        </div>

        <hr class="border-secondary/10" />

        <div class="flex gap-4">
          <span class="text-muted text-center">
            If you find the tool or source code useful, you can
          </span>
          <div class="flex gap-4">
            <a
              href="https://ko-fi.com/deniszholob"
              target="_blank"
              rel="noopener"
              class="link link-primary"
            >
              Buy me Ko-fi
            </a>

            <a
              href="https://patreon.com/deniszholob"
              target="_blank"
              rel="noopener"
              class="link link-primary"
            >
              Support me on Patreon
            </a>
          </div>
        </div>
      </section>

      <hr class="my-4 w-full border-primary/50" />

      <div class="flex flex-row flex-wrap gap-4">
        <div id="Image" class="container-max card m-auto flex flex-col gap-4 p-4">
          <div id="ImageUpload" class="flex flex-col items-center justify-between rounded-md">
            <label for="imageInput" class="mb-2 text-xl">
              <div class="label">
                <span class="label-text">Upload Tile Set</span>
                <span class="label-text-alt font-bold" id="uploadImageDimensions"></span>
              </div>
              <div class="flex flex-col justify-center gap-4">
                <input
                  type="file"
                  id="imageInput"
                  accept="image/*"
                  class="file-input file-input-bordered file-input-primary"
                  onchange="onImageUpload()"
                />
                <img
                  id="uploadImagePreview"
                  alt="Upload Image"
                  class="image-pixelated m-auto h-40 w-auto object-contain"
                />
              </div>
              <div class="label">
                <span class="label-text-alt">Square Tile Based on Tileset:</span>
                <span class="label-text-alt" id="tileSize">---</span>
              </div>
            </label>
          </div>
        </div>

        <!-- <hr class="my-4 w-full border-primary/50" /> -->

        <div id="Settings" class="container-max m-auto flex flex-col gap-4">
          <div class="card flex flex-row gap-4 p-4">
            <label class="form-control cursor-pointer" for="sourceImageBorderSizeInput">
              <div class="label">
                <span class="label-text">Source Image Border (px):</span>
              </div>
              <input
                type="number"
                id="sourceImageBorderSizeInput"
                value="0"
                oninput="onUpdateSourceImageBorderSize()"
                class="input input-bordered input-primary max-w-20"
              />
            </label>

            <label class="form-control max-w-xs cursor-pointer" for="sourceTileBorderSizeInput">
              <div class="label">
                <span class="label-text">Source Tile Border (px):</span>
              </div>
              <input
                type="number"
                id="sourceTileBorderSizeInput"
                value="0"
                oninput="onUpdateSourceTileBorderSize()"
                class="input input-bordered input-primary max-w-20"
              />
            </label>
          </div>

          <div class="card flex flex-row flex-wrap items-baseline gap-4 p-4">
            <label class="form-control max-w-xs cursor-pointer" for="outputImageBorderSizeInput">
              <div class="label">
                <span class="label-text">Output Image Border (px):</span>
              </div>
              <input
                type="number"
                id="outputImageBorderSizeInput"
                value="0"
                oninput="onUpdateOutputImageBorderSize()"
                class="input input-bordered input-primary max-w-20"
                disabled
              />
            </label>

            <label class="form-control max-w-xs cursor-pointer" for="outputTileBorderSizeInput">
              <div class="label">
                <span class="label-text">Output Tile Border (px):</span>
              </div>
              <input
                type="number"
                id="outputTileBorderSizeInput"
                value="0"
                oninput="onUpdateOutputTileBorderSize()"
                class="input input-bordered input-primary max-w-20"
              />
            </label>

            <div class="flex flex-row gap-2">
              <label class="form-control max-w-xs cursor-pointer" for="bgColorInput">
                <div class="label">
                  <span class="label-text">BG Color</span>
                </div>
                <div class="input-color input input-bordered">
                  <input
                    type="color"
                    id="bgColorInput"
                    value="#ffffff"
                    oninput="onUpdateBgColor()"
                  />
                </div>
              </label>

              <label class="form-control max-w-xs cursor-pointer" for="bgAlphaInput">
                <div class="label">
                  <span class="label-text">BG Alpha</span>
                </div>
                <input
                  type="range"
                  id="bgAlphaInput"
                  min="0"
                  max="100"
                  value="0"
                  class="range"
                  step="25"
                  oninput="onUpdateBgAlpha()"
                />
                <div class="flex w-full justify-between px-2 text-xs">
                  <span>0</span> <span>25</span> <span>50</span> <span>75</span>
                  <span>100</span>
                </div>
              </label>
            </div>

            <label class="form-control max-w-xs cursor-pointer" for="renderTileIds">
              <div class="label">
                <span class="label-text">Show Tile ID</span>
              </div>
              <input
                type="checkbox"
                id="renderTileIds"
                checked="checked"
                oninput="onToggleRenderTileIds()"
                class="toggle toggle-primary toggle-lg"
              />
            </label>
            <!--
            <button onclick="onProcessImage()" class="btn btn-primary self-end">
              Re Process Image
            </button>
            -->
          </div>
        </div>
      </div>

      <hr class="my-4 w-full border-primary/50" />

      <div id="Preview" class="mb-4 flex flex-row flex-wrap justify-evenly gap-4">
        <div class="card flex flex-1 flex-col gap-8 rounded-md p-4 shadow-xl">
          <div>
            <h2 class="pb-4 text-center text-xl">Tiled Input</h2>
            <label for="inputTileSetSelect" class="form-control">
              <div class="label">
                <span class="label-text">Input Tile Set</span>
                <a
                  id="inputTileSetLink"
                  href=""
                  target="_blank"
                  rel="noopener noreferrer"
                  class="link label-text-alt link-primary"
                ></a>
              </div>

              <select
                id="inputTileSetSelect"
                class="select select-primary"
                onchange="onUpdateInputTileSet()"
              >
                <option value="0" selected>Option 0</option>
              </select>
            </label>
          </div>

          <a id="inputImageBitMaskLink" download="input_image_bit_mask.png">
            <p class="mb-2 text-center">
              Input Bit Mask <span class="font-bold" id="inputImageBitMaskDimensions"></span>
            </p>
            <img
              id="inputImageBitMask"
              class="image-pixelated bg-checkerboard m-auto h-96 w-auto border border-secondary object-contain"
              alt="Input Bit Mask"
            />
          </a>

          <div>
            <p class="mb-2 text-center">
              Input Tile Set
              <span class="font-bold" id="inputImagePreviewDimensions"></span>
              <br />
              <a
                id="inputImagePreviewLinkGodotTres"
                href=""
                target="_blank"
                rel="noopener noreferrer"
                class="link label-text-alt link-primary hidden text-base"
              >
                <i class="fa-solid fa-download"></i> Godot Resource .tres
              </a>
            </p>
            <a id="inputImagePreviewLink" download="input_image.png">
              <img
                id="inputImagePreview"
                class="image-pixelated bg-checkerboard m-auto h-96 w-auto border border-secondary object-contain"
                alt="Input Tile Set"
              />
            </a>
          </div>
        </div>

        <div class="card flex flex-1 flex-col gap-8 rounded-md p-4 shadow-xl">
          <div>
            <h2 class="pb-4 text-center text-xl">Tiled Output</h2>

            <label for="outputTileSetSelect" class="form-control">
              <div class="label">
                <span class="label-text">Output Tile Set</span>
                <a
                  id="outputTileSetLink"
                  href=""
                  target="_blank"
                  rel="noopener noreferrer"
                  class="link label-text-alt link-primary"
                ></a>
              </div>

              <select
                id="outputTileSetSelect"
                class="select select-primary"
                onchange="onUpdateOutputTileSet()"
              >
                <option value="0" selected>Option 0</option>
              </select>
            </label>
          </div>

          <a id="outputImageBitMaskLink" download="output_image_bit_mask.png">
            <p class="mb-2 text-center">
              Output Bit Mask <span class="font-bold" id="outputImageBitMaskDimensions"></span>
            </p>
            <img
              id="outputImageBitMask"
              class="image-pixelated bg-checkerboard m-auto h-96 w-auto border border-gray-300 object-contain"
              alt="Output Bit Mask"
            />
          </a>

          <div>
            <p class="mb-2 text-center">
              Output Tile Set
              <span class="font-bold" id="outputImagePreviewDimensions"></span>
              <br />
              <a
                id="outputImagePreviewLinkGodotTres"
                href=""
                target="_blank"
                rel="noopener noreferrer"
                class="link label-text-alt link-primary hidden text-base"
              >
                <i class="fa-solid fa-download"></i> Godot Resource .tres
              </a>
            </p>
            <a id="outputImagePreviewLink" download="output_image.png">
              <img
                id="outputImagePreview"
                class="image-pixelated bg-checkerboard m-auto h-96 w-auto border border-gray-300 object-contain"
                alt="Output Tile Set"
              />
            </a>
          </div>
        </div>
      </div>
      Note: Some large resolution images may fail to load/download, sometimes right clicking to view
      image in new tab helps. Or opening the page again via the header links (reload doesn't always
      work for some reason)

      <hr class="my-4 w-full border-primary/50" />
      <br />
    </div>

    <!-- https://jakearchibald.com/2017/es-modules-in-browsers/ -->
    <script src="./js/pages/formatter/formatter-page.js" type="module"></script>
    <noscript> Please enable JavaScript to continue using this application. </noscript>
  </body>
</html>
