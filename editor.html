<!doctype html>
<html lang="en">
  <head>
    <!-- Meta Data -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Denis Zholob" />
    <meta name="keywords" content="Denis, Zholob" />
    <meta name="title" content="Tileset Format Tool" />
    <meta
      name="description"
      content="Tile set tool to convert wetween different tile set formats, and modify borders."
    />

    <!-- Google / Search Engine Tags -->
    <meta itemprop="name" content="Tileset Format Tool" />
    <meta
      itemprop="description"
      content="Tile set tool to convert wetween different tile set formats, and modify borders."
    />
    <meta itemprop="image" content="assets/icons/splash.png" />

    <!-- Facebook Meta Tags -->
    <meta property="og:url" content="https://github.com/deniszholob/tileset-format-tool" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Tileset Format Tool" />
    <meta
      property="og:description"
      content="Tile set tool to convert wetween different tile set formats, and modify borders."
    />
    <meta property="og:image" content="assets/icons/splash.png" />
    <meta property="og:author" content="Denis Zholob" />

    <!-- Twitter Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Tileset Format Tool" />
    <meta
      name="twitter:description"
      content="Tile set tool to convert wetween different tile set formats, and modify borders."
    />
    <meta name="twitter:image" content="assets/icons/splash.png" />
    <meta name="twitter:site" content="@deniszholob" />
    <meta name="twitter:creator" content="@deniszholob" />

    <!-- Title/Icon -->
    <title>Tileset Format Tool | Editor</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png" />
    <link rel="apple-touch-startup-image" href="assets/icons/splash.jpg" />
    <link rel="mask-icon" href="safari-pinned-tab.svg" color="#ffffff" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <!-- <base href="/" /> -->

    <!-- PWA -->
    <link rel="manifest" href="manifest.webmanifest" />
    <meta name="theme-color" content="#ffffff" />

    <!-- Meta Tags Generated via http://heymeta.com -->
    <!-- Icons generated with https://realfavicongenerator.net/ -->

    <!-- Prefetch/Preconnect -->
    <!-- <link rel="dns-prefetch" href="https://fonts.googleapis.com"> -->
    <!-- <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="anonymous"> -->
    <!-- <link rel="dns-prefetch" href="https://fonts.gstatic.com/s/"> -->
    <!-- <link rel="preconnect" href="https://fonts.gstatic.com/s/" crossorigin="anonymous"> -->
    <link rel="dns-prefetch" href="https://use.fontawesome.com" />
    <link rel="preconnect" href="https://use.fontawesome.com" crossorigin="anonymous" />

    <!-- Bootstrap -->
    <!-- <link rel="stylesheet" href="//stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
      crossorigin="anonymous"> -->

    <!-- Fonts -->
    <!-- https://fonts.google.com/specimen/VT323?preview.text=0123456789&query=VT323+ -->
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet" />
    <script
      defer
      src="https://use.fontawesome.com/releases/v6.4.0/js/all.js"
      integrity="sha384-Y7LSKwoY+C2iyfu/oupNnkGEN3EgA6skmJeVg5AyQk7ttcjX0XsLREmmuJW/SdbU"
      crossorigin="anonymous"
    ></script>

    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-28080172-12"></script>
    <script async="">
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "UA-28080172-12");
    </script>

    <!-- Stylesheets -->
    <link rel="stylesheet" href="./styles/styles.css" />
  </head>

  <body class="min-w-screen flex h-svh min-h-screen flex-col justify-center" onload="onLoad()">
    <!-- Without this image doesn't load programmatically for some reason -->
    <img id="bitMask32" src="assets/bit-mask-tiles-bw_32.png" class="hidden" />
    <img id="bitMask64" src="assets/bit-mask-tiles-bw_64.png" class="hidden" />

    <div class="m-auto h-full w-full p-4" style="max-width: 1920px">
      <section id="header" class="m-0 flex flex-col gap-2 rounded-btn bg-neutral p-4">
        <div class="flex flex-row flex-wrap items-center justify-center gap-4">
          <div class="flex flex-row items-center gap-4">
            <h1 class="text-3xl">Tile Set Tool</h1>
            <a
              href="https://gamedev.stackexchange.com/questions/148460/combinations-for-tiling-two-textures-together/148464#148464"
              target="_blank"
              rel="noopener noreferrer"
              class="link link-info tooltip tooltip-right"
              data-tip="Tile Sets Overview"
            >
              <i class="fa-solid fa-circle-info fa-lg"></i>
            </a>
          </div>

          <div id="navLinks" class="flex flex-1 flex-row flex-wrap justify-center gap-10">
            <!-- Inject templateNavItem instances here -->
          </div>
          <template id="templateNavItem">
            <a id="templateNavLink_idx_" href="./page.html" class="link link-secondary text-xl">
              PageTitle
            </a>
          </template>

          <div class="flex flex-none flex-row items-center gap-4">
            <a
              class="link link-primary tooltip tooltip-left"
              data-tip="Discord Chat"
              href="https://discord.gg/PkyzXzz"
            >
              <i class="fa-brands fa-discord fa-xl"></i>
            </a>

            <a
              class="link link-primary tooltip tooltip-left"
              data-tip="Github Source Code"
              href="https://github.com/deniszholob/tileset-format-tool"
            >
              <i class="fa-brands fa-github fa-xl"></i>
            </a>

            <div class="flex flex-col text-center text-sm">
              <span>Updated</span>
              <span id="updateDate"></span>
            </div>

            <!-- TODO: Enable theme switch -->
            <label class="swap swap-rotate">
              <input type="checkbox" class="theme-controller" value="dark" disabled />
              <i class="fa-solid fa-sun fa-lg swap-on text-amber-500"></i>
              <i class="fa-solid fa-moon fa-lg swap-off text-purple-500"></i>
            </label>
          </div>
        </div>

        <hr class="border-secondary/10" />

        <div class="flex gap-4">
          <span class="text-muted text-center">
            If you find the tool or source code useful, you can
          </span>
          <div class="flex gap-4">
            <a
              href="https://ko-fi.com/deniszholob"
              target="_blank"
              rel="noopener"
              class="link link-primary"
            >
              Buy me Ko-fi
            </a>

            <a
              href="https://patreon.com/deniszholob"
              target="_blank"
              rel="noopener"
              class="link link-primary"
            >
              Support me on Patreon
            </a>
          </div>
        </div>
      </section>

      <!-- <hr class="my-4 w-full border-primary/50" /> -->
      <br />

      <div class="container-max m-auto flex flex-row flex-wrap justify-center gap-4">
        <!-- <div>
          <button onclick="onSaveTileSets()" class="bg-blue-500 text-white px-4 py-2 rounded-md">
            Save Tile Sets Config <br />
            <small>(To browser local storage)</small>
          </button>
        </div> -->
        <div>
          <button onclick="onUploadTileSets()" class="btn-vertical btn btn-outline btn-primary">
            Upload Tile Sets Config <br />
            <small>(To browser local storage)</small>
          </button>
        </div>
        <div>
          <button onclick="onDownloadTileSets()" class="btn-vertical btn btn-outline btn-primary">
            Download Tile Sets Config<br />
            <small>(Json from local storage)</small>
          </button>
        </div>
        <div>
          <button onclick="onResetTileSets()" class="btn-vertical btn btn-outline btn-error">
            Reset Tile Sets Config <br />
            <small>(Clear local storage, reset to default)</small>
          </button>
        </div>
        <div>
          <button onclick="onClearTileSets()" class="btn-vertical btn btn-outline btn-error">
            Clear Tile Sets Config <br />
            <small>(Clear all entries)</small>
          </button>
        </div>
      </div>

      <hr class="my-4 w-full border-primary/50" />

      <div id="editorSpace" class="container-max m-auto flex hidden flex-col">
        <div class="chat chat-start">
          <div class="avatar chat-image">
            <div class="w-10 rounded-full bg-neutral text-accent">
              <i class="fa-solid fa-robot fa-xl"></i>
            </div>
          </div>
          <div class="chat-bubble">
            Create your own tile set rule set to use in the formatter. <br />
            Use numbers from -1 to 255 to represent the main tiles <br />
            Use _tag suffix to represent any variations <br />
            e.g. If you have multiple grass tiles, you can encode them like 255, 255_a, 255_b <br />
            The number part will share the same bit mask, the suffix will differentiate the textures
            <br />
            Use empty space for empty tiles <br />
          </div>
        </div>

        <div class="tileSet card card-body flex flex-row gap-4">
          <div class="flex flex-col gap-4">
            <label class="form-control max-w-xs cursor-pointer" for="editTileSetName">
              <div class="label">
                <span class="label-text">Tile Set Name</span>
              </div>
              <input
                id="editTileSetName"
                class="input input-bordered input-primary"
                type="text"
                placeholder="New"
                onchange="onUpdateEditTileSetName()"
                onkeyup="onUpdateEditTileSetName()"
              />
            </label>

            <label for="editTileSetLink">Tile Set Link (Optional)</label>
            <input
              id="editTileSetLink"
              class="input input-bordered input-primary"
              name="editTileSetLink"
              type="text"
              placeholder="https://itch.io/"
              onchange="onUpdateEditTileSetLink()"
              onkeyup="onUpdateEditTileSetLink()"
            />

            <label for="editTileSetConfig">Tile Set Config (CSV)</label>
            <textarea
              id="editTileSetConfig"
              class="textarea textarea-bordered textarea-primary"
              name="editTileSetConfig"
              cols="40"
              rows="10"
              placeholder="255, 255
255, 255
"
              onchange="onUpdateEditTileSetConfig()"
              onkeyup="onUpdateEditTileSetConfig()"
            ></textarea>

            <div id="editTileSetActions">
              <button id="editTileSetSave" class="btn btn-primary">Save</button>
              <button id="editTileSetAdd" class="btn btn-primary" onclick="editTileSetAdd()">
                Add
              </button>
              <button class="btn btn-outline btn-primary" onclick="editTileSetCancel()">
                Cancel
              </button>
              <button class="btn btn-outline btn-error" onclick="editTileSetReset()">Reset</button>
            </div>
          </div>

          <div id="editTileSetPreviewContainer">
            <p id="editTileSetPreviewError" class="text-red-500"></p>
            <a id="editTileSetPreviewLink" download="output_image.png" class="block rounded-md p-4">
              <p class="mb-2 text-center">
                <span id="editTileSetPreviewName"></span>
                <span class="font-bold" id="editTileSetPreviewDimensions"></span>
              </p>
              <img
                id="editTileSetPreview"
                class="image-pixelated bg-checkerboard m-auto w-auto object-contain"
                alt="Preview"
              />
            </a>
          </div>
        </div>
      </div>

      <hr class="my-4 w-full border-primary/50" />

      <div class="container-max m-auto flex flex-col gap-4">
        <div class="m-auto">
          <button class="btn btn-success px-20" onclick="editTileSetNew()">
            <strong class="font-bold">New</strong>
            Tile Set Config
          </button>
        </div>

        <div id="editorList" class="flex flex-col gap-10">
          <!-- Inject List Item template instance here -->
          <div class="m-auto flex w-96 flex-col gap-4">
            <div class="w-full text-center">Loading Tile Set Configurations...</div>
            <div class="skeleton h-64 w-full"></div>
          </div>
        </div>
      </div>

      <!-- List Item Template for editorList -->
      <template id="editorListItemTemplate">
        <div class="card m-auto flex flex-col items-center gap-2 bg-neutral p-8 pt-4 shadow-xl">
          <div class="flex flex-col items-center gap-2">
            <div>
              <button id="editorListItemTemplateEdit" class="btn btn-warning">Edit</button>
              <button id="editorListItemTemplateDelete" class="btn btn-outline btn-error">
                Delete
              </button>
            </div>
            <div>
              <span id="editorListItemTemplateDisplay">Tile Name Here</span>
              <a
                id="editorListItemTemplateLink"
                href="https://opengameart.org/content/swamp-2d-tileset-pixel-art"
                target="_blank"
                rel="noopener noreferrer"
                class="link link-primary"
              >
                LINK
              </a>
            </div>
          </div>
          <div>
            <img
              id="editorListItemTemplatePreview"
              src=""
              alt="Preview"
              class="image-pixelated bg-checkerboard"
            />
          </div>
        </div>
      </template>

      <hr class="my-4 w-full border-primary/50" />
      <br />
    </div>

    <!-- https://jakearchibald.com/2017/es-modules-in-browsers/ -->
    <script src="./js/pages/editor/editor-page.js" type="module"></script>
    <noscript> Please enable JavaScript to continue using this application. </noscript>
  </body>
</html>
